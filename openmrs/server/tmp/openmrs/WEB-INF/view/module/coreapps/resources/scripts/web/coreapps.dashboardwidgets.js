!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dashboardwidgets=e():(t.coreapps=t.coreapps||{},t.coreapps.dashboardwidgets=e())}(this,function(){return webpackJsonpcoreapps__name_([0],{125:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(147);e.default=r.default.module("openmrs-contrib-dashboardwidgets.dataintegrityviolations",[s.default]).component(l.DatatIntegrityViolationsComponent.selector,l.DatatIntegrityViolationsComponent).name},126:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(4),c=o(l),u=n(154);e.default=r.default.module("openmrs-contrib-dashboardwidgets.latestobsforconceptlist",[s.default,c.default]).component(u.LatestObsForConceptListComponent.selector,u.LatestObsForConceptListComponent).name},127:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(4),c=o(l),u=n(156);e.default=r.default.module("openmrs-contrib-dashboardwidgets.obsacrossencounters",[s.default,c.default]).component(u.ObsAcrossEncountersComponent.selector,u.ObsAcrossEncountersComponent).name},128:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(134),c=o(l),u=n(4),d=o(u),p=n(158);e.default=r.default.module("openmrs-contrib-dashboardwidgets.obsgraph",[s.default,d.default,c.default]).component(p.ObsGraphComponent.selector,p.ObsGraphComponent).config(["ChartJsProvider",function(t){t.setOptions({chartColors:["#00463f"],elements:{line:{tension:0}}})}]).name},129:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(160);e.default=r.default.module("openmrs-contrib-dashboardwidgets.programs",[s.default,s.default]).component(l.ProgramsComponent.selector,l.ProgramsComponent).name},130:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(162);e.default=r.default.module("openmrs-contrib-dashboardwidgets.programstatistics",[s.default,s.default]).component(l.ProgramStatisticsComponent.selector,l.ProgramStatisticsComponent).name},131:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(151),c=o(l),u=n(164);e.default=r.default.module("openmrs-contrib-dashboardwidgets.programstatus",[s.default,c.default,s.default]).component(u.ProgramStatusComponent.selector,u.ProgramStatusComponent).name},132:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(141),c=o(l),u=n(166);e.default=r.default.module("openmrs-contrib-dashboardwidgets.relationships",[s.default,c.default,s.default]).component(u.RelationshipsComponent.selector,u.RelationshipsComponent).name},133:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i),l=n(4),c=o(l),u=n(168);e.default=r.default.module("openmrs-contrib-dashboardwidgets.visitbyencountertype",[s.default,c.default]).component(u.VisitByEncounterTypeComponent.selector,u.VisitByEncounterTypeComponent).name},146:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(){o(this,t)}return a(t,[{key:"dateToDaysAgoMessage",value:function(t){var e=this.dateToDaysAgo(t);return 0==e?"today":1==e?e+" day ago":e+" days ago"}},{key:"dateToDaysAgo",value:function(t){var e=new Date(t).getTime(),n=Math.floor(((new Date).getTime()-e)/1e3),o=Math.floor(n/86400),a=0;return o>1&&(a=o),a}},{key:"maxAgeToDays",value:function(t){if(void 0!==t){var e=0,n=t.split(" "),o=!0,a=!1,r=void 0;try{for(var i,s=n[Symbol.iterator]();!(o=(i=s.next()).done);o=!0){var l=i.value;l.includes("d")&&(e+=parseInt(l.replace("d",""))),l.includes("w")&&(e+=7*parseInt(l.replace("w",""))),l.includes("m")&&(e+=30*parseInt(l.replace("m",""))),l.includes("y")&&(e+=365*parseInt(l.replace("y","")))}}catch(t){a=!0,r=t}finally{try{!o&&s.return&&s.return()}finally{if(a)throw r}}return e}}},{key:"maxAgeToDate",value:function(t){if(void 0===t)return null;var e=new Date;if(-1!==t.indexOf("d"))t=t.replace("d",""),e.setDate(e.getDate()-parseInt(t));else if(-1!==t.indexOf("w"))t=t.replace("w",""),e.setDate(e.getDate()-7*parseInt(t));else if(-1!==t.indexOf("m"))t=t.replace("m",""),e.setMonth(e.getMonth()-parseInt(t));else{if(-1===t.indexOf("y"))return null;t=t.replace("y",""),e.setDate(e.getYear()-parseInt(t))}return e}}]),t}();e.default=r},147:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.DatatIntegrityViolationsComponent=void 0;var a=n(148),r=o(a),i=n(278),s=o(i);e.DatatIntegrityViolationsComponent={template:s.default,controller:r.default,selector:"dataintegrityviolations",bindings:{config:"<"}}},148:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(e){"ngInject";o(this,t),Object.assign(this,{openmrsRest:e})}return t.$inject=["openmrsRest"],a(t,[{key:"$onInit",value:function(){var t=this;this.dataViolations=[],this.openmrsRest.setBaseAppPath("/coreapps"),this.openmrsRest.getServerUrl().then(function(e){t.serverUrl=e}),angular.isUndefined(this.config.maxResults)&&(this.config.maxResults=6),this.openmrsRest.list("dataintegrity/integrityresults",{patient:this.config.patientUuid,v:"full",limit:this.config.maxResults}).then(function(e){for(var n=0;n<e.results.length;n++)t.dataViolations.push(e.results[n])})}}]),t}();e.default=r},149:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.DatepickerComponent=void 0;var a=n(150),r=o(a),i=n(279),s=o(i);e.DatepickerComponent={template:s.default,controller:r.default,selector:"openmrsDatepicker",bindings:{ngModel:"=",format:"@",language:"@",startDate:"<",endDate:"<",clearBtn:"<"}}},150:function(t,e,n){"use strict";(function(t){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(2),i=(function(t){t&&t.__esModule}(r),function(){function e(t,n,a,r,i,s){"ngInject";o(this,e),Object.assign(this,{$document:t,$element:n,$scope:a,$filter:r,$timeout:i,openmrsTranslate:s})}return e.$inject=["$document","$element","$scope","$filter","$timeout","openmrsTranslate"],a(e,[{key:"$onInit",value:function(){var e=this;this.$document.ready(function(){e.openmrsTranslate.getLanguage().then(function(n){t(e.$element).datepicker({format:e.convertDateFormat(e.format),autoclose:!0,container:"html",language:n,clearBtn:e.clearBtn}).on("changeDate",function(t){null!=t.date?null!=e.ngModel&&e.stripTime(e.ngModel).getTime()===e.stripTime(t.date).getTime()||e.$scope.$apply(function(){e.ngModel=e.stripTime(t.date)}):null!=e.ngModel&&e.$timeout(function(){e.ngModel=null})}),e.$scope.$watch(function(){return e.ngModel},function(t){e.updateDates()}),e.$scope.$watch(function(){return e.startDate},function(t){e.updateDates()}),e.$scope.$watch(function(){return e.endDate},function(t){e.updateDates()})})})}},{key:"updateDates",value:function(){t(this.$element).datepicker("setStartDate",this.stripTime(this.startDate)),t(this.$element).datepicker("setEndDate",this.stripTime(this.endDate)),t(this.$element).datepicker("setDate",this.stripTime(this.ngModel))}},{key:"stripTime",value:function(t){return null==t?null:new Date(t.getFullYear(),t.getMonth(),t.getDate())}},{key:"convertDateFormat",value:function(t){var e={MMMM:"MM",MMM:"M",MM:"mm",M:"m",yyyy:"yy",yy:"y",EEEE:"DD",EEE:"D"},n="";for(var o in e)n=n+o+"|";return n=n.substring(0,n.length-1),t=t.replace(new RegExp(n,"g"),function(t){return e[t]?e[t]:t})}}]),e}());e.default=i}).call(e,n(1))},151:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(3),s=o(i);n(170),n(290),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(152);var l=n(149);e.default=r.default.module("openmrs-contrib-dashboardwidgets.datepicker",[s.default]).component(l.DatepickerComponent.selector,l.DatepickerComponent).name},152:function(t,e,n){"use strict";(function(t){!function(t){t.fn.datepicker.dates.ht={days:["dimanch","lendi","madi","mèkredi","jedi","vandredi","samdi"],daysShort:["dim","len","mad","mek","jed","van","sam"],daysMin:["d","l","ma","me","j","v","s","d"],months:["janvye","fevriye","mas","avril","me","jen","jiyè","out","septanm","oktòb","novanm","desanm"],monthsShort:["jan","fev","mas","avr","me","jen","jiy","out","sep","okt","nov","des"],today:"Jodi a",suffix:[],meridiem:["am","pm"],weekStart:1,format:"dd/mm/yyyy"}}(t)}).call(e,n(1))},153:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(125),s=o(i),l=n(126),c=o(l),u=n(127),d=o(u),p=n(128),f=o(p),h=n(129),m=o(h),g=n(130),v=o(g),y=n(131),w=o(y),P=n(132),b=o(P),k=n(133),$=o(k);e.default=r.default.module("openmrs-contrib-dashboardwidgets",[s.default,c.default,d.default,f.default,m.default,v.default,w.default,b.default,$.default]).name,r.default.element(document).ready(function(){var t=!0,e=!1,n=void 0;try{for(var o,a=document.getElementsByClassName("openmrs-contrib-dashboardwidgets")[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;r.default.bootstrap(i,["openmrs-contrib-dashboardwidgets"])}}catch(t){e=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw n}}})},154:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.LatestObsForConceptListComponent=void 0;var a=n(155),r=o(a),i=n(280),s=o(i);e.LatestObsForConceptListComponent={template:s.default,controller:r.default,selector:"latestobsforconceptlist",scope:{},bindings:{config:"<"}}},155:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$filter:e,openmrsRest:n,widgetsCommons:a})}return t.$inject=["$filter","openmrsRest","widgetsCommons"],a(t,[{key:"$onInit",value:function(){var t=this;this.maxConceptCount=10,this.maxAgeInDays=void 0,this.obs=[],this.openmrsRest.setBaseAppPath("/coreapps"),this.maxAgeInDays=this.widgetsCommons.maxAgeToDays(this.config.maxAge),this.config.concepts=this.config.concepts.replace(/\s/g,"");for(var e=this.config.concepts.split(","),n=0;n<e.length;n++){var o=e[n];this.openmrsRest.list("obs",{patient:this.config.patientUuid,v:"full",concept:o}).then(function(e){if(t.obs.length<t.maxConceptCount&&e.results.length>0){var n=e.results[0];if(angular.isUndefined(t.maxAgeInDays)||t.widgetsCommons.dateToDaysAgo(n.obsDatetime)<=t.maxAgeInDays){if(["8d4a505e-c2cc-11de-8d13-0010c6dffd0f","8d4a591e-c2cc-11de-8d13-0010c6dffd0f","8d4a5af4-c2cc-11de-8d13-0010c6dffd0f"].indexOf(n.concept.datatype.uuid)>-1){var o=t.$filter("date")(new Date(n.value),t.config.dateFormat);n.value=o}else angular.isDefined(n.value.display)&&(n.value=n.value.display);t.obs.push(n)}}})}}}]),t}();e.default=r},156:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ObsAcrossEncountersComponent=void 0;var a=n(157),r=o(a),i=n(281),s=o(i);e.ObsAcrossEncountersComponent={template:s.default,controller:r.default,selector:"obsacrossencounters",bindings:{config:"<"}}},157:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$filter:e,openmrsRest:n,widgetsCommons:a})}return t.$inject=["$filter","openmrsRest","widgetsCommons"],a(t,[{key:"$onInit",value:function(){this.order="desc",this.concepts=[],this.encounters=[],this.openmrsRest.setBaseAppPath("/coreapps"),this.fetchConcepts(),this.fetchEncounters()}},{key:"fetchConcepts",value:function(){var t=this;this.concepts=this.getConfigConceptsAsArray(this.config.concepts);for(var e=0;e<this.concepts.length;e++)this.openmrsRest.getFull("concept/"+this.concepts[e],{v:"custom:(uuid,display,names:(display,conceptNameType)"}).then(function(e){var n=t.concepts.indexOf(e.uuid);t.concepts[n]=t.getConceptWithShortName(e)})}},{key:"fetchEncounters",value:function(){var t=this;this.openmrsRest.get("encounter",{patient:this.config.patientUuid,v:"custom:(uuid,encounterDatetime,obs:(uuid,value,concept:(uuid,datatype),groupMembers)",limit:this.getMaxRecords(),fromdate:this.widgetsCommons.maxAgeToDate(this.config.maxAge),order:this.order}).then(function(e){t.getEncounters(e.results)})}},{key:"getMaxRecords",value:function(){return""==this.config.maxRecords||angular.isUndefined(this.config.maxRecords)?4:this.config.maxRecords}},{key:"getConfigConceptsAsArray",value:function(t){return t.replace(" ","").split(",")}},{key:"getConceptWithShortName",value:function(t){return angular.forEach(t.names,function(e){"SHORT"==e.conceptNameType&&(t.display=e.display)}),t}},{key:"getEncounters",value:function(t){var e=this;angular.forEach(t,function(t){var n={encounterDatetime:t.encounterDatetime,obs:[]},o=!0;angular.forEach(e.getConfigConceptsAsArray(e.config.concepts),function(a){var r=e.getObservationForConcept(t.obs,a);n.obs.push(r),"-"!==r.value&&(o=!1)}),o||e.encounters.push(n)})}},{key:"getObservationForConcept",value:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(null!=o.groupMembers&&0!==o.groupMembers.length)for(var a=0;a<o.groupMembers.length;a++){var r=o.groupMembers[a];if(r.concept.uuid===e){o=r;break}}if(null!=o.value&&o.concept.uuid===e){if(angular.isDefined(o.value.display))o.value=o.value.display;else if(["8d4a505e-c2cc-11de-8d13-0010c6dffd0f","8d4a591e-c2cc-11de-8d13-0010c6dffd0f","8d4a5af4-c2cc-11de-8d13-0010c6dffd0f"].indexOf(o.concept.datatype.uuid)>-1){var i=this.$filter("date")(new Date(o.value),this.config.dateFormat);o.value=i}return o}}return{value:"-"}}}]),t}();e.default=r},158:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ObsGraphComponent=void 0;var a=n(159),r=o(a),i=n(282),s=o(i);e.ObsGraphComponent={template:s.default,controller:r.default,selector:"obsgraph",bindings:{config:"<"}}},159:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$filter:e,openmrsRest:n,widgetsCommons:a})}return t.$inject=["$filter","openmrsRest","widgetsCommons"],a(t,[{key:"$onInit",value:function(){var t=this;this.maxAgeInDays=void 0,this.concept={},this.series=[],this.labels=[],this.data=[[]],this.openmrsRest.setBaseAppPath("/coreapps"),angular.isUndefined(this.config.maxResults)&&(this.config.maxResults=4),this.maxAgeInDays=this.widgetsCommons.maxAgeToDays(this.config.maxAge),this.openmrsRest.list("obs",{patient:this.config.patientUuid,v:"full",limit:this.config.maxResults,concept:this.config.conceptId}).then(function(e){var n=e.results;if(n.length>0){t.concept=n[0].concept,t.series.push(t.concept.display);for(var o=0;o<n.length;o++){var a=n[o];if("Numeric"==a.concept.datatype.display&&(angular.isUndefined(t.maxAgeInDays)||t.widgetsCommons.dateToDaysAgo(a.obsDatetime)<=t.maxAgeInDays)){var r=t.$filter("date")(new Date(a.obsDatetime),t.config.dateFormat);t.labels.unshift(r),t.data[0].unshift(a.value)}}}})}}]),t}();e.default=r},160:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramsComponent=void 0;var a=n(161),r=o(a),i=n(283),s=o(i);e.ProgramsComponent={template:s.default,controller:r.default,selector:"programs",bindings:{config:"<"}}},161:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(2),i=function(t){return t&&t.__esModule?t:{default:t}}(r),s=function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$filter:e,openmrsRest:n,openmrsTranslate:a})}return t.$inject=["$filter","openmrsRest","openmrsTranslate"],a(t,[{key:"$onInit",value:function(){this.dashboardPage="/coreapps/clinicianfacing/patient.page?patientId={{patientUuid}}&dashboard={{dashboard}}",this.programs=[],this.unenrolledPrograms=[],this.patientPrograms=[],this.showAddProgram=!1,this.canEnrollInProgram=!1,this.input={program:""},this.dateFormat=""==this.config.dateFormat||i.default.isUndefined(this.config.dateFormat)?"yyyy-MM-dd":this.config.dateFormat,this.supportedPrograms=[],this.config.supportedPrograms&&(this.supportedPrograms=this.config.supportedPrograms.split(",")),this.activate()}},{key:"activate",value:function(){this.openmrsRest.setBaseAppPath("/coreapps"),this.config.dashboardPage&&(this.dashboardPage=this.config.dashboardPage),this.fetchPrivileges(),this.fetchPrograms().then(this.fetchPatientPrograms.bind(this)).then(this.determineUnenrolledPrograms.bind(this))}},{key:"fetchPrivileges",value:function(){var t=this;this.openmrsRest.get("session",{v:"custom:(privileges)"}).then(function(e){e&&e.user&&i.default.isArray(e.user.privileges)&&e.user.privileges.some(function(t){return"Task: coreapps.enrollInProgram"===t.name})&&(t.canEnrollInProgram=!0)})}},{key:"fetchPrograms",value:function(){var t=this;return this.openmrsRest.get("program",{v:"custom:display,uuid"}).then(function(e){t.getPrograms(e.results)})}},{key:"fetchPatientPrograms",value:function(){var t=this;return this.openmrsRest.get("programenrollment",{patient:this.config.patientUuid,voided:!1,limit:this.getMaxRecords(),v:"custom:program:(uuid,display),dateEnrolled,dateCompleted"}).then(function(e){t.getPatientPrograms(e.results)})}},{key:"getPrograms",value:function(t){var e=this;i.default.forEach(t,function(t){0!=e.supportedPrograms.length&&-1==e.supportedPrograms.indexOf(t.uuid)||e.programs.push(t)})}},{key:"getPatientPrograms",value:function(t){var e=this;this.patientPrograms=[],i.default.forEach(t,function(t){0!=e.supportedPrograms.length&&-1==e.supportedPrograms.indexOf(t.program.uuid)||e.patientPrograms.push(t)})}},{key:"getMaxRecords",value:function(){return""==this.config.maxRecords||i.default.isUndefined(this.config.maxRecords)?20:this.config.maxRecords}},{key:"determineUnenrolledPrograms",value:function(){var t=[];i.default.forEach(this.patientPrograms,function(e){e.dateCompleted||t.push(e.program.uuid)}),this.unenrolledPrograms=this.$filter("filter")(this.programs,function(e){return-1==t.indexOf(e.uuid)})}},{key:"addProgram",value:function(){this.showAddProgram=!0}},{key:"cancelAddProgram",value:function(){this.showAddProgram=!1,this.input.program=""}},{key:"gotoProgramDashboard",value:function(t){if(t||(t=this.input.program),t&&this.config.enableProgramDashboards){var e="";e=Handlebars.compile(this.dashboardPage)({patientUuid:this.config.patientUuid,dashboard:t}),this.openmrsRest.getServerUrl().then(function(t){window.location.href=t+e})}}}]),t}();e.default=s},162:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramStatisticsComponent=void 0;var a=n(163),r=o(a),i=n(284),s=o(i);e.ProgramStatisticsComponent={template:s.default,controller:r.default,selector:"programstatistics",bindings:{config:"<"}}},163:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(2),i=(function(t){t&&t.__esModule}(r),function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$filter:e,openmrsRest:n,openmrsTranslate:a})}return t.$inject=["$filter","openmrsRest","openmrsTranslate"],a(t,[{key:"$onInit",value:function(){this.activate()}},{key:"activate",value:function(){this.openmrsRest.setBaseAppPath("/coreapps"),this.getEverEnrolledInProgram(),this.getCurrentlyEnrolledInProgram()}},{key:"getEverEnrolledInProgram",value:function(){var t=this;return this.openmrsRest.get("reportingrest/cohort",{v:"ref",uuid:"reporting.library.cohortDefinition.builtIn.patientsWithEnrollment",programs:[this.config.program]}).then(function(e){t.everEnrolled=e&&"count"in e?e.count:t.$filter("translate")("coreapps.dashboardwidgets.programstatistics.error")})}},{key:"getCurrentlyEnrolledInProgram",value:function(){var t=this;return this.openmrsRest.get("reportingrest/cohort",{v:"ref",uuid:"reporting.library.cohortDefinition.builtIn.patientsInProgram",programs:[this.config.program],onDate:new Date}).then(function(e){t.currentlyEnrolled=e&&"count"in e?e.count:t.$filter("translate")("coreapps.dashboardwidgets.programstatistics.error")})}}]),t}());e.default=i},164:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramStatusComponent=void 0;var a=n(165),r=o(a),i=n(285),s=o(i);e.ProgramStatusComponent={template:s.default,controller:r.default,selector:"programstatus",bindings:{config:"<"}}},165:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=n(2),s=o(i),l=n(0),c=o(l),u=function(){function t(e,n,o,r,i){"ngInject";a(this,t),Object.assign(this,{$filter:e,$window:n,$q:o,openmrsRest:r,openmrsTranslate:i})}return t.$inject=["$filter","$window","$q","openmrsRest","openmrsTranslate"],r(t,[{key:"$onInit",value:function(){this.vPatientProgram="custom:uuid,program:(uuid),dateEnrolled,dateCompleted,outcome:(display),location:(display,uuid),dateCompleted,outcome,states:(uuid,startDate,endDate,voided,state:(uuid,concept:(display)))",this.dateFormat=""==this.config.dateFormat||s.default.isUndefined(this.config.dateFormat)?"dd-MMM-yyyy":this.config.dateFormat,this.today=new Date,this.loaded=!1,this.deleted=!1,this.program=null,this.patientProgram=null,this.patientPrograms=null,this.programLocations=null,this.programOutcomes=null,this.minEnrollmentDate=null,this.maxCompletionDate=null,this.canEnrollInProgram=!1,this.canEditProgram=!1,this.canDeleteProgram=!1,this.statesByWorkflow={},this.statesByUuid={},this.sortedStatesByWorkflow={},this.input={dateEnrolled:null,enrollmentLocation:null,dateCompleted:null,outcome:null,initialWorkflowStateByWorkflow:{},changeToStateByWorkflow:{}},this.resetWindowStates(),this.activate()}},{key:"activate",value:function(){var t=this;this.openmrsRest.setBaseAppPath("/coreapps"),this.fetchPrivileges(),this.fetchLocations().then(function(e){t.fetchProgram().then(function(e){t.fetchOutcomes(),t.fetchPatientProgram()})})}},{key:"fetchPrivileges",value:function(){var t=this;this.openmrsRest.get("session",{v:"custom:(privileges)"}).then(function(e){e&&e.user&&s.default.isArray(e.user.privileges)&&(e.user.privileges.some(function(t){return"Task: coreapps.enrollInProgram"===t.name})&&(t.canEnrollInProgram=!0),e.user.privileges.some(function(t){return"Task: coreapps.editPatientProgram"===t.name})&&(t.canEditProgram=!0),e.user.privileges.some(function(t){return"Task: coreapps.deletePatientProgram"===t.name})&&(t.canDeleteProgram=!0))})}},{key:"setInputsToStartingValues",value:function(){this.input.dateEnrolled=this.patientProgram?new Date(this.patientProgram.dateEnrolled):null,this.input.dateCompleted=this.patientProgram&&this.patientProgram.dateCompleted?new Date(this.patientProgram.dateCompleted):null,this.input.outcome=this.patientProgram&&this.patientProgram.outcome?this.patientProgram.outcome.uuid:null,this.patientProgram&&this.patientProgram.location?this.input.enrollmentLocation=this.patientProgram.location.uuid:this.programLocations&&1==this.programLocations.length&&(this.input.enrollmentLocation=this.programLocations[0].uuid),this.input.initialWorkflowStateByWorkflow={},this.input.changeToStateByWorkflow={}}},{key:"convertDateEnrolledAndDateCompletedStringsToDates",value:function(){this.patientProgram&&(this.patientProgram.dateEnrolled=this.patientProgram?new Date(this.patientProgram.dateEnrolled):null,this.patientProgram.dateCompleted=this.patientProgram&&this.patientProgram.dateCompleted?new Date(this.patientProgram.dateCompleted):null)}},{key:"toggleEditEnrollment",value:function(){var t=this.edit.enrollment;this.cancelAllEditModes(),this.setInputsToStartingValues(),this.edit.enrollment=!t}},{key:"toggleEditWorkflow",value:function(t){var e=this.edit.workflow[t];this.cancelAllEditModes(),this.setInputsToStartingValues(),!t in this.edit.workflow?this.edit.workflow[t]=!0:this.edit.workflow[t]=!e}},{key:"toggleExpandedWorkflow",value:function(t){!t in this.expanded.workflow?this.expanded.workflow[t]=!0:this.expanded.workflow[t]=!this.expanded.workflow[t]}},{key:"fetchProgram",value:function(){var t=this;return this.openmrsRest.get("program",{uuid:this.config.program,v:"custom:display,uuid,outcomesConcept:(uuid),workflows:(uuid,concept:(display),states:(uuid,initial,terminal,concept:(display))"}).then(function(e){t.program=e,s.default.forEach(t.program.workflows,function(e){t.statesByWorkflow[e.uuid]=e.states,s.default.forEach(e.states,function(e){t.statesByUuid[e.uuid]=e})})})}},{key:"fetchPatientProgram",value:function(){var t=this;return this.loaded=!1,this.patientProgram=null,this.resetWindowStates(),this.openmrsRest.get("programenrollment",{patient:this.config.patientUuid,v:this.vPatientProgram}).then(function(e){t.patientPrograms=e.results,t.getPatientProgramFromPatientProgramList(),t.groupAndSortPatientStates(),t.setInputsToStartingValues(),t.convertDateEnrolledAndDateCompletedStringsToDates(),t.loaded=!0})}},{key:"fetchLocations",value:function(){var t=this;return this.openmrsRest.get("location",{v:"custom:display,uuid",tag:this.config.locationTag}).then(function(e){t.programLocations=e.results})}},{key:"fetchOutcomes",value:function(){var t=this;if(this.program.outcomesConcept)return this.openmrsRest.get("concept",{v:"custom:answers:(display,uuid)",uuid:this.program.outcomesConcept.uuid}).then(function(e){t.programOutcomes=e.answers})}},{key:"getPatientProgramFromPatientProgramList",value:function(){var t=this;this.patientPrograms=this.$filter("filter")(this.patientPrograms,function(e){return e.program.uuid==t.config.program}),this.patientPrograms.length>0&&(this.patientPrograms=this.$filter("orderBy")(this.patientPrograms,function(e){return-t.patientPrograms.startDate}),this.displayActiveProgram()?this.patientPrograms[0].dateCompleted?this.minEnrollmentDate=this.getNextDay(new Date(this.patientPrograms[0].dateCompleted)):(this.patientProgram=this.patientPrograms[0],this.patientPrograms.length>1&&(this.minEnrollmentDate=this.getNextDay(new Date(this.patientPrograms[1].dateCompleted)))):s.default.forEach(this.patientPrograms,function(e,n){e.uuid==t.config.patientProgram&&(t.patientProgram=e,n>0&&(t.maxCompletionDate=t.getPreviousDay(new Date(t.patientPrograms[n-1].dateEnrolled))),n+1<t.patientPrograms.length&&(t.minEnrollmentDate=t.getNextDay(new Date(t.patientPrograms[n+1].dateCompleted))))}))}},{key:"enrollInProgram",value:function(){var t=this;if(this.input.dateEnrolled&&this.input.enrollmentLocation){var e=[];s.default.forEach(this.input.initialWorkflowStateByWorkflow,function(n){n.startDate=t.input.dateEnrolled,e.push(n)}),this.openmrsRest.create("programenrollment",{patient:this.config.patientUuid,program:this.config.program,dateEnrolled:this.input.dateEnrolled,location:this.input.enrollmentLocation,states:e}).then(function(e){t.config.disableReloadPage?t.fetchPatientProgram(t.patientProgram.uuid):t.reloadPage()})}}},{key:"updatePatientProgram",value:function(){var t=this,e=!this.config.disableReloadPage&&this.input.dateEnrolled.getTime()!=this.patientProgram.dateEnrolled.getTime()||this.input.dateCompleted&&!this.patientProgram.dateCompleted||!this.input.dateCompleted&&this.patientProgram.dateCompleted||this.input.dateCompleted&&this.patientProgram.dateCompleted&&this.input.dateCompleted.getTime()!=this.patientProgram.dateCompleted.getTime();this.openmrsRest.update("programenrollment/"+this.patientProgram.uuid,{dateEnrolled:this.input.dateEnrolled,dateCompleted:this.input.dateCompleted,location:this.input.enrollmentLocation,outcome:this.input.outcome}).then(function(n){e?t.reloadPage():t.fetchPatientProgram(t.patientProgram.uuid)})}},{key:"deletePatientProgram",value:function(){var t=this;this.confirmDelete.enrollment?(this.confirmDelete.enrollment=!1,this.openmrsRest.remove("programenrollment/",{uuid:this.patientProgram.uuid}).then(function(e){t.patientProgram=null,t.displayActiveProgram()?t.fetchPatientProgram():(t.deleted=!0,t.config.disableReloadPage||t.reloadPage())})):this.confirmDelete.enrollment=!0}},{key:"deleteMostRecentPatientState",value:function(t){this.confirmDelete.workflow[t]?(this.confirmDelete.workflow[t]=!1,t in this.sortedStatesByWorkflow&&this.sortedStatesByWorkflow[t].length>0&&this.voidPatientState(this.sortedStatesByWorkflow[t][0].uuid)):this.confirmDelete.workflow[t]=!0}},{key:"createPatientState",value:function(t){var e=this;this.openmrsRest.update("programenrollment/"+this.patientProgram.uuid,{states:[{state:t.state,startDate:t.date}]}).then(function(n){e.statesByUuid[t.state].terminal?e.reloadPage():e.fetchPatientProgram(e.patientProgram.uuid)})}},{key:"getWorkflowForState",value:function(t){var e=void 0;return s.default.forEach(this.program.workflows,function(n){s.default.forEach(n.states,function(o){t.uuid==o.uuid&&(e=n)})}),e}},{key:"voidPatientState",value:function(t){var e=this;return this.openmrsRest.remove("programenrollment/"+this.patientProgram.uuid+"/state/"+t,{voided:"true",voidReason:"voided via UI"}).then(function(t){e.fetchPatientProgram(e.patientProgram.uuid)})}},{key:"updatePatientState",value:function(t,e){this.edit.workflow[t]=!1,this.createPatientState(this.input.changeToStateByWorkflow[t])}},{key:"isNotCurrentState",value:function(t){var e=this;return function(n){var o=t.uuid in e.sortedStatesByWorkflow?e.sortedStatesByWorkflow[t.uuid][0]:null;return!o||o.state.uuid!=n.uuid}}},{key:"isInitialState",value:function(){return function(t){return t.initial}}},{key:"groupAndSortPatientStates",value:function(){var t=this;this.sortedStatesByWorkflow={},this.patientProgram&&this.patientProgram.states&&(this.patientProgram.states=this.$filter("filter")(this.patientProgram.states,function(t){return!t.voided},!0),this.patientProgram.states=this.$filter("orderBy")(this.patientProgram.states,function(t){return t.startDate}),s.default.forEach(this.patientProgram.states,function(e){var n=t.getWorkflowForState(e.state);n.uuid in t.sortedStatesByWorkflow||(t.sortedStatesByWorkflow[n.uuid]=[]);var o={startDate:new Date(e.startDate),dayAfterStartDate:t.getNextDay(e.startDate),endDate:e.endDate?new Date(e.endDate):null,state:e.state,uuid:e.uuid};t.sortedStatesByWorkflow[n.uuid].unshift(o)}))}},{key:"getMostRecentStateChangeDate",value:function(){var t=null;return s.default.forEach(this.sortedStatesByWorkflow,function(e){e.length>0&&(!t||e[0].startDate>t)&&(t=e[0].startDate)}),t}},{key:"update",value:function(){this.cancelAllEditModes(),this.updatePatientProgram()}},{key:"cancelAllEditModes",value:function(){this.edit.enrollment=!1;for(var t in this.edit.workflow)this.edit.workflow[t]=!1}},{key:"cancelEdit",value:function(){this.cancelAllEditModes(),this.setInputsToStartingValues()}},{key:"cancelEnrollment",value:function(){this.expanded.enrollment=!1,this.setInputsToStartingValues()}},{key:"cancelDelete",value:function(){this.confirmDelete={enrollment:!1,workflow:{}}}},{key:"inConfirmDelete",value:function(){if(!0===this.confirmDelete.enrollment)return!0;var t=!1;return s.default.forEach(this.confirmDelete.workflow,function(e,n){!0===e&&(t=!0)}),t}},{key:"inEditMode",value:function(){if(!0===this.edit.enrollment)return!0;var t=!1;return s.default.forEach(this.edit.workflow,function(e,n){!0===e&&(t=!0)}),t}},{key:"getNextDay",value:function(t){return(0,c.default)(t).add(1,"days").toDate()}},{key:"getPreviousDay",value:function(t){return(0,c.default)(t).add(-1,"days").toDate()}},{key:"isToday",value:function(t){return!!t&&(0,c.default)(t).isSame((0,c.default)(),"day")}},{key:"isMostRecentProgram",value:function(){return!this.patientPrograms||0==this.patientPrograms.length||!this.patientProgram||this.patientPrograms[0].uuid===this.patientProgram.uuid}},{key:"displayActiveProgram",value:function(){return!this.config.patientProgram}},{key:"programIsCompleted",value:function(){return!(!this.patientProgram||!this.patientProgram.dateCompleted)}},{key:"enrollmentValid",value:function(){return this.input.enrollmentLocation&&this.input.dateEnrolled&&(!this.input.dateCompleted||this.input.dateCompleted>=this.input.dateEnrolled)&&(!this.input.dateCompleted&&!this.input.outcome||this.input.dateCompleted&&this.input.outcome)&&(this.isMostRecentProgram()||this.input.dateCompleted)}},{key:"workflowTransitionValid",value:function(t){return this.input.changeToStateByWorkflow[t]&&this.input.changeToStateByWorkflow[t].date&&this.input.changeToStateByWorkflow[t].state}},{key:"resetWindowStates",value:function(){this.edit={enrollment:!1,workflow:{}},this.expanded={enrollment:!1,workflow:{}},this.confirmDelete={enrollment:!1,workflow:{}}}},{key:"reloadPage",value:function(){this.$window.location.reload()}}]),t}();e.default=u},166:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.RelationshipsComponent=void 0;var a=n(167),r=o(a),i=n(286),s=o(i);e.RelationshipsComponent={template:s.default,controller:r.default,selector:"relationships",bindings:{config:"<"}}},167:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(2),i=function(t){return t&&t.__esModule?t:{default:t}}(r),s=function(){function t(e,n,a){"ngInject";o(this,t),Object.assign(this,{$q:e,openmrsRest:n,openmrsTranslate:a})}return t.$inject=["$q","openmrsRest","openmrsTranslate"],a(t,[{key:"$onInit",value:function(){this.minSearchLength=2,this.dashboardPage="/coreapps/clinicianfacing/patient.page?patientId={{patientUuid}}",this.providerPage=null,this.relationships=[],this.types=[],this.allowedTypes=[],this.relationshipType=[],this.hasEditPrivileges=!1,this.edit=!1,this.removeFlag=!1,this.showFindOtherPerson=!1,this.showSaveButton=!1,this.searchPerson=null,this.otherPerson=null,this.relatedPersons=[],this.activate()}},{key:"activate",value:function(){var t=this;this.config.baseAppPath?this.openmrsRest.setBaseAppPath(this.config.baseAppPath):this.openmrsRest.setBaseAppPath("/coreapps"),this.config.dashboardPage&&(this.dashboardPage=this.config.dashboardPage),this.config.providerPage&&(this.providerPage=this.config.providerPage),this.config.includeRelationshipTypes&&(this.allowedTypes=this.config.includeRelationshipTypes.split(",")),this.openmrsRest.get("session",{v:"custom:(privileges)"}).then(function(e){t.getPrivileges(e.user.privileges)}),this.openmrsRest.get("relationship",{person:this.config.patientUuid,limit:this.getMaxRecords(),v:"custom:(uuid,personA:(uuid,display,personName,birthdate,isPatient,personId),personB:(uuid,display,personName,birthdate,isPatient,personId),relationshipType)"}).then(function(e){t.getRelationships(e.results),t.providerPage&&t.checkForProviders()}),this.openmrsRest.get("relationshiptype",{v:"default"}).then(function(e){t.getRelationshipTypes(e.results)})}},{key:"getRelationships",value:function(t){var e=this;i.default.forEach(t,function(t){var n={};n.uuid=t.uuid,n.isProvider=!1,t.personA.uuid!==e.config.patientUuid?(n.toPerson=t.personA,n.isPatient=t.personA.isPatient,n.type=i.default.isDefined(t.relationshipType.displayAIsToB)?t.relationshipType.displayAIsToB:t.relationshipType.aIsToB):(n.toPerson=t.personB,n.isPatient=t.personB.isPatient,n.type=i.default.isDefined(t.relationshipType.displayBIsToA)?t.relationshipType.displayBIsToA:t.relationshipType.bIsToA),e.relationships.push(n)})}},{key:"relationshipsContain",value:function(t){var e=!1;return i.default.forEach(this.relationships,function(n){n.toPerson.uuid==t&&(e=!0)}),e}},{key:"getPrivileges",value:function(t){var e=this.config.editPrivilege;i.default.isDefined(e)&&i.default.isArray(t)&&t.some(function(t){return t.name===e})&&(this.hasEditPrivileges=!0)}},{key:"updateProviderInfo",value:function(t){t&&i.default.forEach(this.relationships,function(e){e.toPerson.uuid===t.person.uuid&&(e.isProvider=!0)})}},{key:"isProvider",value:function(t,e){return this.openmrsRest.get("provider",{q:e,v:"custom:(uuid,identifier,display,person:(uuid,personId,display,gender,age,birthdate,birthdateEstimated))"}).then(function(t){return t.results})}},{key:"checkForProviders",value:function(){var t=this;i.default.forEach(this.relationships,function(e){t.isProvider(e.toPerson.uuid,e.toPerson.display).then(function(e){i.default.forEach(e,function(e){t.updateProviderInfo(e)})})})}},{key:"getPersons",value:function(t){var e=this;this.openmrsRest.get("patient",{q:t,v:"custom:(uuid,display,gender,age)"}).then(function(t){e.relatedPersons=[],e.filterSearchedPersons(t.results)})}},{key:"filterSearchedPersons",value:function(t){var e=this;i.default.isArray(t)&&t.length>0&&i.default.forEach(t,function(t){e.relationshipsContain(t.uuid)||e.relatedPersons.push(t)})}},{key:"getRelationshipTypes",value:function(t){var e=this;i.default.forEach(t,function(t){if(e.allowedTypes.length<1||e.allowedTypes.length>0&&-1!==e.allowedTypes.indexOf(t.uuid)){if(null==e.findRelTypeByName(i.default.isDefined(t.displayAIsToB)?t.displayAIsToB:t.aIsToB)){var n={};n.uuid=t.uuid,n.name=i.default.isDefined(t.displayAIsToB)?t.displayAIsToB:t.aIsToB,n.type="B",e.types.push(n)}if(null==e.findRelTypeByName(i.default.isDefined(t.displayBIsToA)?t.displayBIsToA:t.bIsToA)){var o={};o.uuid=t.uuid,o.name=i.default.isDefined(t.displayBIsToA)?t.displayBIsToA:t.bIsToA,o.type="A",e.types.push(o)}}})}},{key:"updateRelationshipType",value:function(){i.default.isDefined(this.relationshipType)&&(this.showFindOtherPerson=!0)}},{key:"findRelTypeByName",value:function(t){var e=null;return i.default.isDefined(this.types)&&this.types.length>0&&i.default.forEach(this.types,function(n){n.name==t&&(e=n)}),e}},{key:"getMaxRecords",value:function(){return""==this.config.maxRecords||i.default.isUndefined(this.config.maxRecords)?6:this.config.maxRecords}},{key:"navigateTo",value:function(t){var e=this,n="";i.default.forEach(this.relationships,function(o){o.toPerson.uuid===t&&(!0===o.isPatient?e.dashboardPage&&(n=Handlebars.compile(e.dashboardPage)({patientUuid:t})):!0===o.isProvider&&e.providerPage&&(n=Handlebars.compile(e.providerPage)({personUuid:t})))}),this.openmrsRest.getServerUrl().then(function(t){window.location.href=t+n})}},{key:"addRelationship",value:function(){this.edit=!0}},{key:"save",value:function(){var t=this;if(i.default.isDefined(this.relationshipType)&&i.default.isDefined(this.otherPerson)){var e=null,n=null;"A"==this.relationshipType.type?(e=this.config.patientUuid,n=this.otherPerson.uuid):"B"==this.relationshipType.type&&(e=this.otherPerson.uuid,n=this.config.patientUuid),this.openmrsRest.create("relationship",{relationshipType:this.relationshipType.uuid,personA:e,personB:n}).then(function(e){t.$onInit()})}}},{key:"removeRelationship",value:function(t){if(i.default.isDefined(t)){this.removeFlag=!0;var e=[];i.default.forEach(this.relationships,function(n){n.uuid==t&&e.push(n)}),this.relationships=[],this.relationships=e}}},{key:"remove",value:function(){var t=this;i.default.isDefined(this.relationships)&&1==this.relationships.length&&this.openmrsRest.remove("relationship",{uuid:this.relationships[0].uuid}).then(function(e){t.$onInit()})}},{key:"goTo",value:function(t){this.navigateTo(t)}},{key:"searchPersons",value:function(){i.default.isDefined(this.searchPerson)&&this.searchPerson.length>this.minSearchLength&&this.getPersons(this.searchPerson)}},{key:"onSelect",value:function(t,e,n){i.default.isDefined(t)&&i.default.isDefined(this.relationshipType)&&(this.otherPerson=t,this.showSaveButton=!0)}},{key:"cancel",value:function(){this.edit=!1,this.$onInit()}}]),t}();e.default=s},168:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.VisitByEncounterTypeComponent=void 0;var a=n(169),r=o(a),i=n(287),s=o(i);e.VisitByEncounterTypeComponent={template:s.default,controller:r.default,selector:"visitbyencountertype",bindings:{config:"<"}}},169:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(){function t(e,n){"ngInject";o(this,t),Object.assign(this,{openmrsRest:e,widgetsCommons:n})}return t.$inject=["openmrsRest","widgetsCommons"],a(t,[{key:"$onInit",value:function(){var t=this;this.visits=[],this.serverUrl="",this.openmrsRest.setBaseAppPath("/coreapps"),this.openmrsRest.getServerUrl().then(function(e){t.serverUrl=e}),this.openmrsRest.get("visit",{patient:this.config.patientUuid,limit:this.getMaxRecords(),fromStartDate:this.widgetsCommons.maxAgeToDate(this.config.maxAge),v:"custom:(uuid,startDatetime,stopDatetime,encounters:(uuid,encounterType:(uuid,display)))"}).then(function(e){t.getVisits(e.results)})}},{key:"getVisits",value:function(t){var e=this;angular.forEach(t,function(t){var n=[];if(e.getCombineEncounterTypes()){var o={startDatetime:t.startDatetime,encounterType:"",uuid:t.uuid};angular.forEach(t.encounters,function(t){-1==n.indexOf(t.encounterType.display)&&(""===o.encounterType?o.encounterType=t.encounterType.display:o.encounterType+=", "+t.encounterType.display,n.push(t.encounterType.display))}),e.visits.push(o)}else angular.forEach(t.encounters,function(o){if(-1==n.indexOf(o.encounterType.display)){var a={startDatetime:t.startDatetime};a.encounterType=o.encounterType.display,n.push(o.encounterType.display),e.visits.push(a)}})})}},{key:"getCombineEncounterTypes",value:function(){return"false"!==this.config.combineEncounterTypes}},{key:"getMaxRecords",value:function(){return""==this.config.maxRecords||angular.isUndefined(this.config.maxRecords)?6:this.config.maxRecords}}]),t}();e.default=r},277:function(t,e,n){function o(t){return n(a(t))}function a(t){var e=r[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var r={"./af":10,"./af.js":10,"./ar":17,"./ar-dz":11,"./ar-dz.js":11,"./ar-kw":12,"./ar-kw.js":12,"./ar-ly":13,"./ar-ly.js":13,"./ar-ma":14,"./ar-ma.js":14,"./ar-sa":15,"./ar-sa.js":15,"./ar-tn":16,"./ar-tn.js":16,"./ar.js":17,"./az":18,"./az.js":18,"./be":19,"./be.js":19,"./bg":20,"./bg.js":20,"./bn":21,"./bn.js":21,"./bo":22,"./bo.js":22,"./br":23,"./br.js":23,"./bs":24,"./bs.js":24,"./ca":25,"./ca.js":25,"./cs":26,"./cs.js":26,"./cv":27,"./cv.js":27,"./cy":28,"./cy.js":28,"./da":29,"./da.js":29,"./de":32,"./de-at":30,"./de-at.js":30,"./de-ch":31,"./de-ch.js":31,"./de.js":32,"./dv":33,"./dv.js":33,"./el":34,"./el.js":34,"./en-au":35,"./en-au.js":35,"./en-ca":36,"./en-ca.js":36,"./en-gb":37,"./en-gb.js":37,"./en-ie":38,"./en-ie.js":38,"./en-nz":39,"./en-nz.js":39,"./eo":40,"./eo.js":40,"./es":42,"./es-do":41,"./es-do.js":41,"./es.js":42,"./et":43,"./et.js":43,"./eu":44,"./eu.js":44,"./fa":45,"./fa.js":45,"./fi":46,"./fi.js":46,"./fo":47,"./fo.js":47,"./fr":50,"./fr-ca":48,"./fr-ca.js":48,"./fr-ch":49,"./fr-ch.js":49,"./fr.js":50,"./fy":51,"./fy.js":51,"./gd":52,"./gd.js":52,"./gl":53,"./gl.js":53,"./gom-latn":54,"./gom-latn.js":54,"./he":55,"./he.js":55,"./hi":56,"./hi.js":56,"./hr":57,"./hr.js":57,"./hu":58,"./hu.js":58,"./hy-am":59,"./hy-am.js":59,"./id":60,"./id.js":60,"./is":61,"./is.js":61,"./it":62,"./it.js":62,"./ja":63,"./ja.js":63,"./jv":64,"./jv.js":64,"./ka":65,"./ka.js":65,"./kk":66,"./kk.js":66,"./km":67,"./km.js":67,"./kn":68,"./kn.js":68,"./ko":69,"./ko.js":69,"./ky":70,"./ky.js":70,"./lb":71,"./lb.js":71,"./lo":72,"./lo.js":72,"./lt":73,"./lt.js":73,"./lv":74,"./lv.js":74,"./me":75,"./me.js":75,"./mi":76,"./mi.js":76,"./mk":77,"./mk.js":77,"./ml":78,"./ml.js":78,"./mr":79,"./mr.js":79,"./ms":81,"./ms-my":80,"./ms-my.js":80,"./ms.js":81,"./my":82,"./my.js":82,"./nb":83,"./nb.js":83,"./ne":84,"./ne.js":84,"./nl":86,"./nl-be":85,"./nl-be.js":85,"./nl.js":86,"./nn":87,"./nn.js":87,"./pa-in":88,"./pa-in.js":88,"./pl":89,"./pl.js":89,"./pt":91,"./pt-br":90,"./pt-br.js":90,"./pt.js":91,"./ro":92,"./ro.js":92,"./ru":93,"./ru.js":93,"./sd":94,"./sd.js":94,"./se":95,"./se.js":95,"./si":96,"./si.js":96,"./sk":97,"./sk.js":97,"./sl":98,"./sl.js":98,"./sq":99,"./sq.js":99,"./sr":101,"./sr-cyrl":100,"./sr-cyrl.js":100,"./sr.js":101,"./ss":102,"./ss.js":102,"./sv":103,"./sv.js":103,"./sw":104,"./sw.js":104,"./ta":105,"./ta.js":105,"./te":106,"./te.js":106,"./tet":107,"./tet.js":107,"./th":108,"./th.js":108,"./tl-ph":109,"./tl-ph.js":109,"./tlh":110,"./tlh.js":110,"./tr":111,"./tr.js":111,"./tzl":112,"./tzl.js":112,"./tzm":114,"./tzm-latn":113,"./tzm-latn.js":113,"./tzm.js":114,"./uk":115,"./uk.js":115,"./ur":116,"./ur.js":116,"./uz":118,"./uz-latn":117,"./uz-latn.js":117,"./uz.js":118,"./vi":119,"./vi.js":119,"./x-pseudo":120,"./x-pseudo.js":120,"./yo":121,"./yo.js":121,"./zh-cn":122,"./zh-cn.js":122,"./zh-hk":123,"./zh-hk.js":123,"./zh-tw":124,"./zh-tw.js":124};o.keys=function(){return Object.keys(r)},o.resolve=a,t.exports=o,o.id=277},278:function(t,e){t.exports='<div ng-if="$ctrl.dataViolations.length != 0">\n    <ul>\n        <li ng-repeat="dataViolation in $ctrl.dataViolations">\n            <div style="margin: 5px">\n                <div class="tag" ng-if="dataViolation.actionUrl">\n                    <a style="color: white" href="{{$ctrl.serverUrl}}/{{dataViolation.actionUrl}}">\n                        <strong>\n                            Fix\n                        </strong>\n                    </a>\n                </div>\n                <div>\n                    {{ dataViolation.notes ? dataViolation.notes : dataViolation.rule.ruleName}}\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>\n<div ng-if="$ctrl.dataViolations.length == 0">\n    None\n</div>'},279:function(t,e){t.exports='<div class="input-group date">\n    <input type="text" class="form-control" readonly="readonly">\n    <div class="input-group-addon">\n        <span class="icon-calendar"></span>\n    </div>\n</div>\n'},280:function(t,e){t.exports='<ul>\n    <li ng-repeat="obs in $ctrl.obs">\n        <div style="display: block; overflow: hidden; padding-right: 5px; padding-bottom: 2px">\n            <span style="float: left">\n                {{obs.concept.name.display}}: <strong>{{obs.value}}</strong>\n            </span>\n            <span style="float: right; font-size: small; color: #939393">\n                {{$ctrl.widgetsCommons.dateToDaysAgoMessage(obs.obsDatetime)}}\n            </span>\n        </div>\n    </li>\n</ul>'},281:function(t,e){t.exports='<table ng-if="$ctrl.encounters.length != 0">\n    <thead>\n        <tr>\n            <th>Encounter</th>\n            <th ng-repeat="concept in $ctrl.concepts">{{concept.display}}</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr ng-repeat="encounter in $ctrl.encounters| orderBy: \'-encounterDatetime\'">\n            <th style="white-space: nowrap;">{{encounter.encounterDatetime | date: $ctrl.config.dateFormat}}</th>\n            <th ng-repeat="ob in encounter.obs">\n                {{ob.value}}\n            </th>\n        </tr>\n    </tbody>\n</table>\n<p ng-if="$ctrl.encounters.length == 0">None</p>'},282:function(t,e){t.exports='<div ng-if="$ctrl.series.length > 0">\n    <div style="padding-bottom: 10px">\n        <strong>\n            {{$ctrl.concept.display}}\n        </strong>\n    </div>\n    <canvas class="chart chart-line" chart-data="$ctrl.data" chart-labels="$ctrl.labels"\n            chart-series="$ctrl.series"></canvas>\n</div>\n<div ng-if="$ctrl.series.length === 0">\n    None\n</div>'},283:function(t,e){t.exports='\x3c!-- NOTE: work-in-progress, consider this not yet an "official" release of this widgets, future changes may not be backwards-compatible and change functionality signficantly --\x3e\n\n\x3c!-- TODO move styles to separate file? --\x3e\n\n<style>\n    #cancel-button {\n        padding: 2px 5px;\n        margin: 5px;\n        font-size: 0.8em;;\n    }\n\n    #enroll-button {\n        padding: 2px 5px;\n        margin: 5px;\n        font-size: 0.8em;;\n    }\n</style>\n<ul>\n    <li ng-show="$ctrl.patientPrograms.length != 0" ng-repeat="patientProgram in $ctrl.patientPrograms | orderBy: \'-dateEnrolled\'">\n        <a ng-click="$ctrl.gotoProgramDashboard(patientProgram.program.uuid)">\n            {{ patientProgram.program.display }}\n        </a>\n\n        <div ng-show="!patientProgram.dateCompleted" class="tag">{{ patientProgram.dateEnrolled | date:$ctrl.dateFormat }} - {{\'coreapps.dashboardwidgets.programs.current\' | translate }}</div>\n        <div ng-show="patientProgram.dateCompleted" class="tag">{{ patientProgram.dateEnrolled | date:$ctrl.dateFormat }} - {{ patientProgram.dateCompleted | date:$ctrl.dateFormat }}</div>\n    </li>\n\n    <li ng-show="$ctrl.patientPrograms.length == 0">\n        {{\'coreapps.none\' | translate }}\n    </li>\n\n</ul>\n\n\n<div ng-show="$ctrl.canEnrollInProgram && !$ctrl.showAddProgram && $ctrl.config.enableProgramDashboards && $ctrl.unenrolledPrograms && $ctrl.unenrolledPrograms.length > 0">\n    <a class="add-link" ng-click="$ctrl.addProgram()">\n        <i class="icon-plus-sign" title="{{\'coreapps.dashboardwidgets.programs.addProgram\' | translate }}"/>\n    </a>\n</div>\n\n<div ng-show="$ctrl.showAddProgram">\n    <div>\n        <select  ng-model="$ctrl.input.program"\n                 ng-options="program.uuid as program.display for program in $ctrl.unenrolledPrograms">\n            <option value="">{{\'coreapps.dashboardwidgets.programs.selectProgram\' | translate }}:</option>\n        </select>\n        <br/>\n    </div>\n    <div>\n        <button id="enroll-button" class="confirm" ng-click="$ctrl.gotoProgramDashboard()">{{\'coreapps.enroll\' | translate }}</button>\n        <button id="cancel-button" class="cancel" ng-click="$ctrl.cancelAddProgram()">{{\'coreapps.cancel\' | translate }}</button>\n    </div>\n</div>'},284:function(t,e){t.exports="<ul>\n    <li>{{'coreapps.dashboardwidgets.programstatistics.currentlyEnrolled' | translate }}: {{  $ctrl.currentlyEnrolled != null ? $ctrl.currentlyEnrolled : 'coreapps.dashboardwidgets.programstatistics.loading' | translate }}</li>\n    <li>{{'coreapps.dashboardwidgets.programstatistics.everEnrolled' | translate }}: {{  $ctrl.everEnrolled != null ? $ctrl.everEnrolled : 'coreapps.dashboardwidgets.programstatistics.loading' | translate }}</li>\n</ul>"},285:function(t,e){t.exports='\x3c!-- TODO: move css to separate file? the the "workflow-header" is a super hack, should be fixed by someone who understands css bettter --\x3e\n\x3c!-- input-group-addon is to fix alignment of calendar icons on date pickers --\x3e\n\n<style>\n\n    .input-group-addon {\n        display: inline-block;;\n    }\n\n    input {\n        width: 80%\n    }\n\n    .programstatus-fieldset, .programstatus-field {\n        padding-top: 2px;\n        padding-bottom: 2px;\n    }\n\n    .workflow-section {\n        padding-top: 5px;\n    }\n\n    .workflow-table {\n        border: none !important;\n        font-size: 0.8em !important;\n        background: #f9f9f9 !important;\n    }\n\n    .workflow-header  {\n        width: 100% !important;\n        text-align: left !important;\n    }\n\n    .workflow-cell {\n        border: none !important;\n        font-size: 0.8em !important;\n    }\n\n    .hidden {\n        visibility: hidden;\n    }\n\n    .center {\n        margin-left: 0px;\n        margin-right: 0px;\n        text-align: center;\n    }\n\n    .bold {\n        font-weight: bold;\n    }\n\n</style>\n\n<div ng-show="$ctrl.deleted">\n    {{ \'coreapps.dashboardwidgets.programstatus.programDeleted\' | translate }}\n</div>\n\n<div ng-show="$ctrl.loaded && !$ctrl.deleted">\n    <div ng-show="$ctrl.canEnrollInProgram && !$ctrl.patientProgram && $ctrl.expanded.enrollment">\n        <fieldset class="programstatus-fieldset">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.enrollmentdate\' | translate }}</h3>\n\t\t\t<p class="programstatus-field">\n                <openmrs-datepicker ng-model="$ctrl.input.dateEnrolled"\n                                    format="{{$ctrl.dateFormat}}"\n                                    start-date="$ctrl.minEnrollmentDate"\n                                    end-date="$ctrl.today"/>\n            </p>\n        </fieldset>\n        <fieldset class="programstatus-fieldset">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.enrollmentlocation\' | translate }}</h3>\n            <p class="programstatus-field">\n                <select ng-model="$ctrl.input.enrollmentLocation"\n                        ng-options="location.uuid as location.display for location in $ctrl.programLocations">\n                </select>\n            </p>\n        </fieldset>\n        <div ng-repeat="workflow in $ctrl.program.workflows track by $index" ng-show="$ctrl.program.workflows.length != 0">\n            <fieldset class="programstatus-fieldset">\n                <h3>{{ workflow.concept.display }}</h3>\n                <p class="programstatus-field">\n                    <select ng-model="$ctrl.input.initialWorkflowStateByWorkflow[workflow.uuid].state"\n                            ng-options="state.uuid as state.concept.display for state in $ctrl.statesByWorkflow[workflow.uuid] | filter: $ctrl.isInitialState() | orderBy: \'concept.display\' ">\n                        <option value=""></option>\n                    </select>\n                </p>\n            </fieldset>\n        </div>\n        <div class="center">\n            <button class="confirm" ng-disabled="!$ctrl.enrollmentValid()" ng-click="$ctrl.enrollInProgram()">{{\'coreapps.enroll\' | translate }}</button>\n            <button class="cancel" ng-click="$ctrl.cancelEnrollment()">{{\'coreapps.cancel\' | translate }}</button>\n        </div>\n    </div>\n\n    <div ng-show="$ctrl.canEnrollInProgram && !$ctrl.patientProgram && !$ctrl.expanded.enrollment">\n        <div class="center">\n            {{ \'coreapps.dashboardwidgets.programstatus.notCurrentlyEnrolled\' | translate }}\n        </div>\n        <div class="center">\n            <button class="confirm" ng-click="$ctrl.expanded.enrollment = true">{{\'coreapps.enroll\' | translate }}</button>\n        </div>\n    </div>\n\n    <div ng-show="$ctrl.patientProgram">\n\n        \x3c!-- VIEW sections --\x3e\n\n        <fieldset  class="programstatus-fieldset" ng-show="!$ctrl.edit.enrollment">\n            <i ng-show="$ctrl.canDeleteProgram && !$ctrl.inEditMode() && !$ctrl.inConfirmDelete()" ng-click="$ctrl.deletePatientProgram()" class="icon-remove right"/>\n            <i ng-show="$ctrl.canEditProgram && !$ctrl.inEditMode() && !$ctrl.inConfirmDelete()" ng-click="$ctrl.toggleEditEnrollment()" class="icon-pencil right"/>\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.enrolled\' | translate }}</h3>\n            <p class="programstatus-field">{{ $ctrl.patientProgram.dateEnrolled | date:$ctrl.dateFormat }}</p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset"  ng-show="!$ctrl.edit.enrollment">\n            <h3>{{\'coreapps.location\' | translate }}</h3>\n            <p class="programstatus-field">{{ $ctrl.patientProgram.location.display }}</p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset" ng-show="!$ctrl.edit.enrollment && $ctrl.programIsCompleted()">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.completed\' | translate }}</h3>\n            <p class="programstatus-field">{{ $ctrl.patientProgram.dateCompleted | date:$ctrl.dateFormat }}</p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset" ng-show="$ctrl.programOutcomes && !$ctrl.edit.enrollment && $ctrl.programIsCompleted()">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.outcome\' | translate }}</h3>\n            <p class="programstatus-field">{{ $ctrl.patientProgram.outcome.display }}</p>\n        </fieldset>\n\n        \x3c!-- EDIT sections --\x3e\n        <fieldset class="programstatus-fieldset" ng-show="$ctrl.edit.enrollment">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.enrolled\' | translate }}</h3>\n            <p class="programstatus-field">\n                <openmrs-datepicker ng-model="$ctrl.input.dateEnrolled"\n                                    format="{{$ctrl.dateFormat}}"\n                                    start-date="$ctrl.minEnrollmentDate"\n                                    end-date="$ctrl.input.dateCompleted ? $ctrl.input.dateCompleted : $ctrl.today"\n                                    language="{{$ctrl.language}}"/>\n            </p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset" ng-show="$ctrl.edit.enrollment">\n            <h3>{{\'coreapps.location\' | translate }}</h3>\n            <p class="programstatus-field">\n                <select ng-model="$ctrl.input.enrollmentLocation"\n                    ng-options="location.uuid as location.display for location in $ctrl.programLocations">\n                </select>\n            </p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset" ng-show="$ctrl.edit.enrollment">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.completed\' | translate }}:</h3>\n            <p class="programstatus-field">\n                <openmrs-datepicker ng-model="$ctrl.input.dateCompleted"\n                                format="{{$ctrl.dateFormat}}"\n                                start-date="$ctrl.getMostRecentStateChangeDate() ? $ctrl.getMostRecentStateChangeDate() : $ctrl.input.dateEnrolled"\n                                end-date="$ctrl.maxCompletionDate ? $ctrl.maxCompletionDate : $ctrl.today"\n                                clear-btn="true"\n                                language="{{$ctrl.language}}"/>\n            </p>\n        </fieldset>\n\n        <fieldset class="programstatus-fieldset" ng-show="$ctrl.programOutcomes && $ctrl.edit.enrollment">\n            <h3>{{\'coreapps.dashboardwidgets.programstatus.outcome\' | translate }}:</h3>\n            <p class="programstatus-field">\n                <select ng-model="$ctrl.input.outcome"\n                    ng-options="outcome.uuid as outcome.display for outcome in $ctrl.programOutcomes | orderBy: \'display\' ">\n                    <option value=""></option>\n                </select>\n            </p>\n        </fieldset>\n\n        <div ng-show="$ctrl.edit.enrollment" class="center">\n            <button class="confirm" ng-disabled="!$ctrl.enrollmentValid()" ng-click="$ctrl.update()">{{\'coreapps.save\' | translate }}</button>  <button class="cancel" ng-click="$ctrl.cancelEdit()">{{\'coreapps.cancel\' | translate }}</button>\n        </div>\n\n        \x3c!-- DELETE confirmation section --\x3e\n\n        <div ng-show="$ctrl.confirmDelete.enrollment" class="center">\n            {{\'coreapps.dashboardwidgets.programstatus.confirmDelete\' | translate }}\n            <br/><br/>\n            <button class="confirm" ng-click="$ctrl.deletePatientProgram()">{{\'coreapps.delete\' | translate }}</button>  <button class="cancel" ng-click="$ctrl.cancelDelete()">{{\'coreapps.cancel\' | translate }}</button>\n        </div>\n\n        \x3c!-- workflow sections --\x3e\n\n        <div class="workflow-section" ng-repeat="workflow in $ctrl.program.workflows track by $index" ng-show="$ctrl.program.workflows.length != 0">\n            \x3c!-- TODO review the use of the "isToday" functionality --\x3e\n            <h3 class="workflow-header">{{ workflow.concept.display }}\n                <i ng-show="$ctrl.canEditProgram && !$ctrl.inEditMode() && !$ctrl.inConfirmDelete() && !$ctrl.isToday($ctrl.sortedStatesByWorkflow[workflow.uuid].startDate)" ng-click="$ctrl.toggleEditWorkflow(workflow.uuid)" class="icon-pencil"/>\n            </h3>\n\n            <fieldset class="programstatus-fieldset" ng-show="$ctrl.edit.workflow[workflow.uuid]">\n                <h3>{{\'coreapps.dashboardwidgets.programstatus.transitionTo\' | translate }}</h3>\n                <p class="programstatus-field">\n                    <select ng-model="$ctrl.input.changeToStateByWorkflow[workflow.uuid].state"\n                            ng-options="state.uuid as state.concept.display for state in $ctrl.statesByWorkflow[workflow.uuid] | filter: $ctrl.isNotCurrentState(workflow) | orderBy: \'concept.display\' ">\n                        <option value=""></option>\n                    </select>\n                </p>\n            </fieldset>\n\n            <fieldset class="programstatus-fieldset" ng-show="$ctrl.edit.workflow[workflow.uuid]">\n                <h3>{{\'coreapps.on\' | translate }}</h3>\n                <p class="programstatus-field">\n                    <openmrs-datepicker ng-model="$ctrl.input.changeToStateByWorkflow[workflow.uuid].date"\n                                        format="{{$ctrl.dateFormat}}"\n                                        start-date="$ctrl.sortedStatesByWorkflow[workflow.uuid] ? $ctrl.sortedStatesByWorkflow[workflow.uuid][0].dayAfterStartDate : $ctrl.input.dateEnrolled"\n                                        end-date="$ctrl.programIsCompleted() ? $ctrl.patientProgram.dateCompleted : $ctrl.today"\n                                        language="{{$ctrl.language}}"/>\n                </p>\n            </fieldset>\n\n            <div ng-show="$ctrl.edit.workflow[workflow.uuid]" class="center">\n                <button class="confirm" ng-disabled="!$ctrl.workflowTransitionValid(workflow.uuid)" ng-click="$ctrl.updatePatientState(workflow.uuid)">{{\'coreapps.save\' | translate }}</button>  <button class="cancel" ng-click="$ctrl.toggleEditWorkflow(workflow.uuid)">{{\'coreapps.cancel\' | translate }}</button>\n            </div>\n\n            <table class="workflow-table">\n                <tr ng-repeat="row in $ctrl.sortedStatesByWorkflow[workflow.uuid]" ng-show="$first || $ctrl.expanded.workflow[workflow.uuid]">\n                    <td class="workflow-cell">\n                        {{ row.startDate | date:$ctrl.dateFormat }}\n                        <span ng-show="!$first">{{\'coreapps.to\' | translate}} {{ row.endDate | date:$ctrl.dateFormat }} </span>\n                    </td>\n                    <td class="workflow-cell" ng-class="{bold:$first}">\n                        {{ row.state.concept.display }}\n                    </td>\n                    <td class="workflow-cell">\n                        <i ng-show="$first && $ctrl.canEditProgram  && !$ctrl.inEditMode() && !$ctrl.inConfirmDelete()" class="icon-remove right" ng-click="$ctrl.deleteMostRecentPatientState(workflow.uuid)"/>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="workflow-cell" colspan="4" ng-show="!$ctrl.expanded.workflow[workflow.uuid] && $ctrl.sortedStatesByWorkflow[workflow.uuid] && $ctrl.sortedStatesByWorkflow[workflow.uuid].length > 1">\n                        <a ng-click="$ctrl.toggleExpandedWorkflow(workflow.uuid)">{{ \'coreapps.showMore\' | translate }}</a>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="workflow-cell" colspan="4" ng-show="$ctrl.expanded.workflow[workflow.uuid] && $ctrl.sortedStatesByWorkflow[workflow.uuid] && $ctrl.sortedStatesByWorkflow[workflow.uuid].length > 1">\n                        <a ng-click="$ctrl.toggleExpandedWorkflow(workflow.uuid)">{{ \'coreapps.showLess\' | translate }}</a>\n                    </td>\n                </tr>\n            </table>\n\n            \x3c!-- DELETE  workflow confirmation section --\x3e\n\n            <div ng-show="$ctrl.confirmDelete.workflow[workflow.uuid]" class="center">\n                {{\'coreapps.dashboardwidgets.programstatus.confirmWorkflowStateDelete\' | translate }}\n                <br/><br/>\n                <button class="confirm" ng-click="$ctrl.deleteMostRecentPatientState(workflow.uuid)">{{\'coreapps.delete\' | translate }}</button>  <button class="cancel" ng-click="$ctrl.cancelDelete()">{{\'coreapps.cancel\' | translate }}</button>\n            </div>\n\n        </div>\n\n\n\n    </div>\n\n</div>\n'},286:function(t,e){t.exports='<ul>\n    <li class="relationship-li" ng-show="$ctrl.relationships.length != 0" ng-repeat="relationship in $ctrl.relationships track by $index">\n        <div class="relationship-wrapper">\n            <div class="fifty-percent relationship-inner">\n                <span>\n                    <a ng-show="relationship.isPatient || relationship.isProvider" ng-click="$ctrl.goTo(relationship.toPerson.uuid)">\n                        {{relationship.toPerson.display ? relationship.toPerson.display : relationship.toPerson.personName.display}}\n                    </a>\n                    <span ng-show="!relationship.isPatient && !relationship.isProvider">{{relationship.toPerson.display ? relationship.toPerson.display : relationship.toPerson.personName.display}}</span>\n                </span>\n            </div>\n            <div class="tag forty-percent relationship-inner">\n                <span ng-show="$ctrl.hasEditPrivileges == true && $ctrl.removeFlag == false && $ctrl.edit == false" class="remove-tag">\n                    <a ng-show="relationship.isPatient" class="remove-link" ng-click="$ctrl.removeRelationship(relationship.uuid)">\n                        <i class="icon-remove" title="Remove relationship"></i>\n                    </a>\n                </span>\n                {{relationship.type}}\n            </div>\n        </div>\n    </li>\n    <p ng-show="$ctrl.relationships.length == 0">\n        {{ \'coreapps.none\' | translate }}\n    </p>\n\n    <li ng-show="$ctrl.removeFlag">\n        {{ \'coreapps.dashboardwidgets.relationships.confirmRemove\' | translate }}\n    </li>\n\n    <li ng-show="$ctrl.hasEditPrivileges && !$ctrl.edit && !$ctrl.removeFlag">\n        <a class="add-link" ng-click="$ctrl.addRelationship()">\n            <i class="icon-plus-sign" title="Add relationship"></i>\n        </a>\n    </li>\n\n    <li ng-show="$ctrl.edit">\n        {{ \'coreapps.dashboardwidgets.relationships.add\' | translate }}\n    </li>\n\n    <li ng-show="$ctrl.edit">\n        <p class="left">\n        <select class="relationship-input" ng-options="type as type.name for type in $ctrl.types"\n                ng-model="$ctrl.relationshipType" ng-change="$ctrl.updateRelationshipType()">\n            <option value="">{{ \'coreapps.dashboardwidgets.relationships.whatType\' | translate }}</option>\n        </select>\n\n        </p>\n    </li>\n    <li ng-show="$ctrl.showFindOtherPerson">\n        &nbsp;\n    </li>\n    <li ng-show="$ctrl.showFindOtherPerson">\n        <p class="left">\n            <input type="text" class="person-typeahead relationship-input" placeholder="{{ \'coreapps.relationships.find\' | translate }} {{ $ctrl.relationshipType.name }}"\n                   ng-model="$ctrl.searchPerson"\n                   typeahead-no-results="noResults"\n                   ng-change="$ctrl.searchPersons()"\n                   uib-typeahead="person as person.display + \' (\' + person.gender + \', \' + (person.age ? person.age:\'\') + \')\' for person in $ctrl.relatedPersons"\n                   typeahead-wait-ms="250"\n                   typeahead-select-on-exact="true"\n                   typeahead-min-length="3"\n                   typeahead-on-select="$ctrl.onSelect($item, $model, $label)"\n                   />\n        </p>\n    </li>\n\n    <li ng-show="$ctrl.edit">\n        <p>\n        <div>\n            <button class="tag" ng-show="$ctrl.showSaveButton" ng-click="$ctrl.save()">{{ \'coreapps.save\' | translate }}</button>\n            <button class="cancel-tag" ng-click="$ctrl.cancel()">{{ \'coreapps.cancel\' | translate }}</button>\n        </div>\n        </p>\n    </li>\n\n    <li ng-show="$ctrl.removeFlag">\n        <p>\n        <div>\n            <button class="tag" ng-click="$ctrl.remove()">{{ \'coreapps.delete\' | translate }}</button>\n            <button class="cancel-tag" ng-click="$ctrl.cancel()">{{ \'coreapps.cancel\' | translate }}</button>\n        </div>\n        </p>\n    </li>\n\n</ul>'},287:function(t,e){t.exports='<ul>\n    <li ng-if="$ctrl.visits.length != 0" ng-repeat="visit in $ctrl.visits track by $index">\n        <a href="{{$ctrl.serverUrl}}/coreapps/patientdashboard/patientDashboard.page?patientId={{$ctrl.config.patientUuid}}&visitId={{visit.uuid}}">\n            {{visit.startDatetime | date: $ctrl.config.dateFormat}}\n        </a>\n        <div class="tag" ng-if="visit.encounterType !== \'\'">{{visit.encounterType}}</div>\n    </li>\n    <p ng-if="$ctrl.visits.length == 0">\n        None\n    </p>\n</ul>'},4:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),r=o(a),i=n(146),s=o(i),l=r.default.module("dashboardwidgets.services",[]);l.service("widgetsCommons",s.default),e.default=l.name}},[153])});
//# sourceMappingURL=coreapps.dashboardwidgets.js.map